const array = [{"id":10151,"name":"Diego Alves Carreira","age":37,"number":null,"position":"Goalkeeper","photo":"https://media.api-sports.io/football/players/10151.png"},{"id":306210,"name":"Matheus Cunha","age":21,"number":null,"position":"Goalkeeper","photo":"https://media.api-sports.io/football/players/306210.png"},{"id":123759,"name":"Hugo Souza","age":23,"number":null,"position":"Goalkeeper","photo":"https://media.api-sports.io/football/players/123759.png"},{"id":195099,"name":"João Fernando","age":21,"number":null,"position":"Goalkeeper","photo":"https://media.api-sports.io/football/players/195099.png"},{"id":10156,"name":"Rodrigo Caio","age":29,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/10156.png"},{"id":15789,"name":"Patrick da Silva Ferreira Souza","age":22,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/15789.png"},{"id":266019,"name":"Diego Damasceno dos Santos","age":19,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/266019.png"},{"id":10157,"name":"Rodinei","age":30,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/10157.png"},{"id":352369,"name":"Richard dos Santos de Almeida","age":19,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/352369.png"},{"id":349001,"name":"Wesley Vinícius França Lima","age":19,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/349001.png"},{"id":10161,"name":"Matheus França Silva","age":22,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/10161.png"},{"id":1344,"name":"M. Isla","age":34,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/1344.png"},{"id":34,"name":"Filipe Luís","age":37,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/34.png"},{"id":2283,"name":"David Luiz","age":35,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/2283.png"},{"id":237160,"name":"Santiago Ocampos Ibarra","age":20,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/237160.png"},{"id":10124,"name":"Léo Pereira","age":26,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/10124.png"},{"id":67944,"name":"Ramon Ramos Lima","age":21,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/67944.png"},{"id":10163,"name":"Renê","age":30,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/10163.png"},{"id":195102,"name":"Gabriel Rodrigues Noga","age":20,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/195102.png"},{"id":340067,"name":"Cleiton Santana dos Santos","age":19,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/340067.png"},{"id":9992,"name":"Gustavo Henrique","age":29,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/9992.png"},{"id":2612,"name":"G. De Arrascaeta","age":28,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/2612.png"},{"id":10168,"name":"Éverton Ribeiro","age":33,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/10168.png"},{"id":80530,"name":"Yuri de Oliveira","age":21,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/80530.png"},{"id":311157,"name":"Matheus França de Oliveira","age":18,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/311157.png"},{"id":195103,"name":"João Victor Gomes da Silva","age":21,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/195103.png"},{"id":352371,"name":"Victor Hugo","age":18,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/352371.png"},{"id":352372,"name":"Matheus Gonçalves","age":17,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/352372.png"},{"id":899,"name":"Andreas Pereira","age":26,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/899.png"},{"id":322067,"name":"Igor","age":19,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/322067.png"},{"id":22231,"name":"Thiago Maia","age":25,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/22231.png"},{"id":352373,"name":"Kayke David","age":19,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/352373.png"},{"id":10171,"name":"Diego Ribas da Cunha","age":37,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/10171.png"},{"id":10173,"name":"Willian Arão","age":30,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/10173.png"},{"id":10321,"name":"Pedro","age":25,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/10321.png"},{"id":10174,"name":"Gabriel Barbosa","age":26,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/10174.png"},{"id":10177,"name":"Vitinho","age":29,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/10177.png"},{"id":266020,"name":"Ryan Luka Cordeiro de Souza","age":19,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/266020.png"},{"id":311158,"name":"Werton de Almeida Rêgo","age":19,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/311158.png"},{"id":306216,"name":"Mateus Dias Lima","age":18,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/306216.png"},{"id":54716,"name":"Thiago Fernandes Rodrigues","age":21,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/54716.png"},{"id":325717,"name":"André Luiz Inácio da Silva","age":20,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/325717.png"},{"id":237103,"name":"Lázaro Vinicius Marques","age":20,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/237103.png"},{"id":352374,"name":"Petterson Novaes Reis","age":18,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/352374.png"},{"id":10180,"name":"Bruno Henrique","age":32,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/10180.png"},{"id":10506,"name":"Marinho","age":32,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/10506.png"}];
const array2 = [{"id":41227,"name":"Muriel Gustavo Becker","age":35,"number":null,"position":"Goalkeeper","photo":"https://media.api-sports.io/football/players/41227.png"},{"id":293555,"name":"Pedro Rangel","age":22,"number":null,"position":"Goalkeeper","photo":"https://media.api-sports.io/football/players/293555.png"},{"id":10298,"name":"Marcos Felipe","age":26,"number":null,"position":"Goalkeeper","photo":"https://media.api-sports.io/football/players/10298.png"},{"id":10080,"name":"Fábio Deivson Lopes Maciel","age":42,"number":null,"position":"Goalkeeper","photo":"https://media.api-sports.io/football/players/10080.png"},{"id":50081,"name":"David Braz","age":35,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/50081.png"},{"id":10552,"name":"Danilo Barcelos","age":31,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/10552.png"},{"id":61809,"name":"Luccas Claro","age":31,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/61809.png"},{"id":105501,"name":"Cris Silva","age":29,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/105501.png"},{"id":10351,"name":"David de Duarte Macedo","age":27,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/10351.png"},{"id":70422,"name":"Luan de Freitas Molarinho Chagas","age":21,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/70422.png"},{"id":10301,"name":"Matheus Ferraz","age":37,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/10301.png"},{"id":10306,"name":"Marcílio Florencio Mota Filho","age":25,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/10306.png"},{"id":63949,"name":"M. Pineida","age":30,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/63949.png"},{"id":10309,"name":"Marlon Rodrigues Xavier","age":25,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/10309.png"},{"id":10237,"name":"Manoel","age":32,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/10237.png"},{"id":10267,"name":"Samuel Xavier","age":32,"number":null,"position":"Defender","photo":"https://media.api-sports.io/football/players/10267.png"},{"id":13708,"name":"Jhon Adolfo Arias Andrade","age":25,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/13708.png"},{"id":133194,"name":"Lucas Felipe Calegari","age":20,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/133194.png"},{"id":10311,"name":"Ganso","age":33,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/10311.png"},{"id":10348,"name":"Yago Felipe da Costa Rocha","age":27,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/10348.png"},{"id":9883,"name":"Nathan Allan de Souza","age":26,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/9883.png"},{"id":280245,"name":"Matheus Martinelli Lima","age":21,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/280245.png"},{"id":10128,"name":"Wellington","age":31,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/10128.png"},{"id":9929,"name":"Felipe Melo de Carvalho","age":39,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/9929.png"},{"id":10396,"name":"Gustavo Nonato Santana","age":24,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/10396.png"},{"id":305817,"name":"Gabriel Teixeira Aragão","age":21,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/305817.png"},{"id":265784,"name":"André Trindade da Costa Neto","age":21,"number":null,"position":"Midfielder","photo":"https://media.api-sports.io/football/players/265784.png"},{"id":297522,"name":"John Kennedy Batista de Souza","age":20,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/297522.png"},{"id":13523,"name":"G. Cano","age":34,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/13523.png"},{"id":10104,"name":"Frederico Chaves Guedes","age":39,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/10104.png"},{"id":10527,"name":"Caio Paulista","age":24,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/10527.png"},{"id":9936,"name":"Willian","age":36,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/9936.png"},{"id":305821,"name":"Matheus Martins Silva dos Santos","age":19,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/305821.png"},{"id":265785,"name":"Luiz Henrique André Rosa da Silva","age":21,"number":null,"position":"Attacker","photo":"https://media.api-sports.io/football/players/265785.png"}];
const positions = ['Defender','Mieldfield','Attacker'];
const paramGame = ['inicio','fim','reinicio'];
let control = paramGame[0];
let posseBola = '';


const defenders1 = array.filter((element)=>element.position==='Defender');
const midfilders1 = array.filter((element)=>element.position==='Midfielder');
const attackers1 = array.filter((element)=>element.position==='Attacker');
const goalkeepers1 = array.filter((element)=>element.position==='Goalkeeper');

const defenders2 = array2.filter((element)=>element.position==='Defender');
const midfilders2 = array2.filter((element)=>element.position==='Midfielder');
const attackers2 = array2.filter((element)=>element.position==='Attacker');
const goalkeepers2 = array2.filter((element)=>element.position==='Goalkeeper');

const randomIndex= (arrayPosition) => Math.floor(Math.random()*arrayPosition.length);

const tactics = '4-4-2'
let paramTactic = '';



let team1;
const defendersLineUp1 =[];
const midfieldersLineUp1 = [];
const attackersLineUp1 =[];

let team2;
const defendersLineUp2 =[];
const midfieldersLineUp2 = [];
const attackersLineUp2 =[];


function createLineTeam(team,players,param,teamParam){
  for (let index = 0; index < param; index+=1) {
     const element = players[randomIndex(players)]
     element.team = teamParam;
     team.push(element);
  }
}

function createTeam1(tactic) {
    
    let paramTactic = tactic.split('-');
    
    createLineTeam(defendersLineUp1,defenders1,paramTactic[0],1);
    createLineTeam(midfieldersLineUp1,midfilders1,paramTactic[1],1);
    createLineTeam(attackersLineUp1,attackers1,paramTactic[2],1);
    const goalkepper1 = goalkeepers1[randomIndex(goalkeepers1)];
    goalkepper1.team = 1;
    team1 = [goalkepper1,...defendersLineUp1,...midfieldersLineUp1,...attackersLineUp1];
    
}
function createTeam2(tactic) {
    let paramTactic = tactic.split('-');
    
    createLineTeam(defendersLineUp2,defenders2,paramTactic[0],2);
    createLineTeam(midfieldersLineUp2,midfilders2,paramTactic[1],2);
    createLineTeam(attackersLineUp2,attackers2,paramTactic[2],2);
    const goalkeepers2 = goalkeepers2[randomIndex(goalkeepers2)];
    goalkeepers2.team = 2;
    team2 = [goalkeepers2,...defendersLineUp2,...midfieldersLineUp2,...attackersLineUp2];
}

 function moveGoalkeeper(team){
 const player = team.find((element)=>element.position ==='Goalkeeper');
 let lineFuture = positions[Math.floor(Math.random()*3)];
 if(lineFuture ==='Defender'){
    let receptorPlayer;
     if(player.team===1){
      receptorPlayer = defendersLineUp1[Math.floor(Math.random()*defendersLineUp1.length)]
     }else{
       receptorPlayer = defendersLineUp2[Math.floor(Math.random()*defendersLineUp2.length)]
     }
     const msg = `${player.name} passa a bola para ${receptorPlayer.name}`
     console.log(msg); 
     return {msg,receptorPlayer};
 }
 if(lineFuture ==='Midfilder'){
     let receptorPlayer;
    if(player.team===1){
        receptorPlayer = midfieldersLineUp1[Math.floor(Math.random()*midfieldersLineUp1.length)]
      }else{
        receptorPlayer = midfieldersLineUp2[Math.floor(Math.random()*midfieldersLineUp2.length)];
      };
    const msg = `${player.name} lança a bola para ${receptorPlayer.name}`
    console.log(msg);
    return {msg,receptorPlayer};
}
if(lineFuture ==='Attacker'){
    let receptorPlayer;
    if(player.team===1){
        receptorPlayer = attackersLineUp1[Math.floor(Math.random()*attackersLineUp1.length)]
      }else{
        receptorPlayer = attackersLineUp2[Math.floor(Math.random()*attackersLineUp2.length)]
      }
    const msg = `${player.name} lança a bola para ${receptorPlayer.name}`
    console.log(msg);
    return {msg,receptorPlayer};
}

}

function moveDefender(player,team){
    let lineFuture = positions[Math.floor(Math.random()*3)];
    if(lineFuture ==='Defender' ){
        let receptorPlayer;
        if(player.team===1){
            receptorPlayer = defendersLineUp1.filter((element)=> element.id !== player.id)[Math.floor(Math.random()*defendersLineUp1.length)]
          }else{
            receptorPlayer = defendersLineUp2.filter((element)=> element.id !== player.id)[Math.floor(Math.random()*defendersLineUp2.length)]
          }
        const msg = `${player.name} passa a bola para ${receptorPlayer.name}`
        console.log(msg); 
        return {msg,receptorPlayer};
    }
    if(lineFuture ==='Midfilder'){
        let receptorPlayer;
        if(player.team===1){
            receptorPlayer = midfieldersLineUp1[Math.floor(Math.random()*midfieldersLineUp1.length)]
          }else{
            receptorPlayer = midfieldersLineUp2[Math.floor(Math.random()*midfieldersLineUp2.length)];
          };
        const msg = `${player.name} passa a bola para ${receptorPlayer.name}`;
        return {msg,receptorPlayer};
    }
    if(lineFuture ==='Attacker'){
        let receptorPlayer;
    if(player.team===1){
        receptorPlayer = attackersLineUp1[Math.floor(Math.random()*attackersLineUp1.length)]
      }else{
        receptorPlayer = attackersLineUp2[Math.floor(Math.random()*attackersLineUp2.length)]
      }
        const msg = `${player.name} passa a bola para ${receptorPlayer.name}`
        console.log(msg);
        return {msg,receptorPlayer};
    }
}

function moveMieldfilder(player,team){
    let lineFuture = positions[Math.floor(Math.random()*3)];
    if(lineFuture ==='Defender' ){
        let receptorPlayer;
        if(player.team===1){
         receptorPlayer = defendersLineUp1[Math.floor(Math.random()*defendersLineUp1.length)]
        }else{
          receptorPlayer = defendersLineUp2[Math.floor(Math.random()*defendersLineUp2.length)]
        }
        const msg = `${player.name} passa a bola para ${receptorPlayer.name}`
        console.log(msg); 
        return {msg,receptorPlayer};
    }
    if(lineFuture ==='Midfilder'){
        let receptorPlayer;
        if(player.team===1){
            receptorPlayer = midfieldersLineUp1.filter((element)=> element.id !== player.id)[Math.floor(Math.random()*midfieldersLineUp1.length)]
          }else{
            receptorPlayer = midfieldersLineUp2.filter((element)=> element.id !== player.id)[Math.floor(Math.random()*midfieldersLineUp2.length)]
          }
        const msg = `${player.name} passa a bola para ${receptorPlayer.name}`
        console.log(msg);
        return {msg,receptorPlayer};
    }
    if(lineFuture ==='Attacker'){
        let receptorPlayer;
       if(player.team===1){
        receptorPlayer = attackersLineUp1[Math.floor(Math.random()*attackersLineUp1.length)]
        }else{
        receptorPlayer = attackersLineUp2[Math.floor(Math.random()*attackersLineUp2.length)]
        }
       const msg = `${player.name} passa a bola para ${receptorPlayer.name}`
        console.log(msg);
        return {msg,receptorPlayer};
    }
}

function moveAttacker(player,team){
    const moves = ['passe','chute'];
    const action = moves[Math.floor(Math.random()*2)];
    const goal = Math.floor(Math.random()*10);
    if(action ==='passe'){
        if(player.team===1){
            receptorPlayer = attackersLineUp1.filter((element)=> element.id !== player.id)[Math.floor(Math.random()*attackersLineUp1.length)];
          }else{
            receptorPlayer = attackersLineUp2.filter((element)=> element.id !== player.id)[Math.floor(Math.random()*attackersLineUp2.length)];
          }
        const msg = `${player.name} toca a bola para ${receptorPlayer.name}`
        console.log(msg);
        return {msg,receptorPlayer};
    }
    if(action ==='chute'){
      if(goal>=7){
          const msg = `Goooolllllll de ${player.name}`;
          control = 'fim';
          return {msg,player};
      }
      let goalKeeperOther = team2.find((element)=>element.position==='Goalkeeper');

      if(player.team === 2){
         goalKeeperOther = team1.find((element)=>element.position==='Goalkeeper');
      }
      if(goal<=3){
          const msg = `${player.name} chuta para fora!!!`
          return {msg,goalKeeperOther};
      }
          const msg = `${player.name} chuta..... e defende ${goalKeeperOther.name}`;
      

    }
    return {msg,goalKeeperOther};
}

function inicioComGoleiro1(){
    // console.log('teste');
    let result = moveGoalkeeper(team1);
    // console.log(result);
    // console.log(result.receptorPlayer);
    while(control !=='fim'){
    if(result.receptorPlayer.position === 'Defender'){
        console.log('defesa');
       result = moveDefender(result.receptorPlayer,team1);
    }else if(result.receptorPlayer.position==='Mieldfielder'){
        console.log('meio');
        result = moveMieldfilder(result.receptorPlayer,team1);
    }else{
        console.log('ataque');
       result = moveAttacker(result.receptorPlayer,team1);
       if(result.receptorPlayer.team===2){
        return inicioComGoleiro2();
       }
    }
}
}

function inicioComGoleiro2(){
    console.log('teste');
    let result = moveGoalkeeper(team2);
    while(control !=='fim'){
    if(result.receptorPlayer.position === 'Defender'){
        console.log('defesa');
       result = moveDefender(result.receptorPlayer,team2);
    }else if(result.receptorPlayer.position==='Mieldfielder'){
        console.log('meio');
        result = moveMieldfilder(result.receptorPlayer,team2);
    }else{
        console.log('ataque');
       result = moveAttacker(result.receptorPlayer,team2);
       if(result.receptorPlayer.team===1){
        return inicioComGoleiro1()
       }
    }
}
}

createTeam1('4-4-2');
createTeam2('4-4-2');

inicioComGoleiro1();
